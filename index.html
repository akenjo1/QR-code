<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trình Tạo Mã QR Pro - Akenjo</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Thư viện QR Code Styling (Mạnh mẽ hơn qrcode.js) -->
    <script type="text/javascript" src="https://unpkg.com/qr-code-styling@1.5.0/lib/qr-code-styling.js"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Be Vietnam Pro', sans-serif; }
        /* Tùy chỉnh thanh cuộn */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        
        /* Hiệu ứng focus cho input */
        .input-group:focus-within label { color: #2563eb; }
        .input-group:focus-within input, .input-group:focus-within select { 
            border-color: #3b82f6; 
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen text-gray-800">

    <!-- Header -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center text-white font-bold text-xl shadow-lg shadow-blue-200">
                    QR
                </div>
                <h1 class="text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-600 to-indigo-600">
                    QR Studio Pro
                </h1>
            </div>
            <a href="#" class="text-sm text-gray-500 hover:text-blue-600 font-medium transition">By Akenjo</a>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
            
            <!-- Cột bên trái: Công cụ chỉnh sửa -->
            <div class="lg:col-span-7 space-y-6">
                
                <!-- 1. Nội dung -->
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
                    <h2 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                        <span class="w-6 h-6 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center text-xs">1</span>
                        Nội dung QR
                    </h2>
                    <div class="input-group">
                        <label class="block text-sm font-medium text-gray-700 mb-2">URL hoặc Văn bản</label>
                        <textarea id="qr-data" rows="3" class="w-full px-4 py-3 rounded-xl border border-gray-200 text-gray-700 placeholder-gray-400 outline-none transition-all resize-none" placeholder="Nhập đường dẫn trang web, văn bản, hoặc số điện thoại..."></textarea>
                    </div>
                </div>

                <!-- 2. Giao diện & Hình dáng -->
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
                    <h2 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                        <span class="w-6 h-6 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center text-xs">2</span>
                        Tùy biến hình dáng
                    </h2>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-5">
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Kiểu chấm (Dots)</label>
                            <select id="dots-style" class="w-full px-4 py-2.5 rounded-lg border border-gray-200 bg-white outline-none transition-all cursor-pointer">
                                <option value="square">Vuông (Cổ điển)</option>
                                <option value="dots">Chấm tròn</option>
                                <option value="rounded" selected>Bo tròn (Rounded)</option>
                                <option value="extra-rounded">Bo tròn mềm</option>
                                <option value="classy">Classy</option>
                                <option value="classy-rounded">Classy Rounded</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Kiểu góc (Corners)</label>
                            <select id="corners-style" class="w-full px-4 py-2.5 rounded-lg border border-gray-200 bg-white outline-none transition-all cursor-pointer">
                                <option value="square">Vuông</option>
                                <option value="dot">Chấm tròn</option>
                                <option value="extra-rounded" selected>Bo tròn</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- 3. Màu sắc -->
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
                    <h2 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                        <span class="w-6 h-6 rounded-full bg-pink-100 text-pink-600 flex items-center justify-center text-xs">3</span>
                        Màu sắc thương hiệu
                    </h2>
                    <div class="grid grid-cols-2 gap-5">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Màu mã QR</label>
                            <div class="flex items-center gap-3">
                                <input type="color" id="color-dots" value="#2563eb" class="w-12 h-12 rounded cursor-pointer border-0 p-0 bg-transparent">
                                <span class="text-xs text-gray-500">Nên chọn màu tối</span>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Màu nền</label>
                            <div class="flex items-center gap-3">
                                <input type="color" id="color-bg" value="#ffffff" class="w-12 h-12 rounded cursor-pointer border-0 p-0 bg-transparent">
                                <span class="text-xs text-gray-500">Nên chọn màu sáng</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 4. Logo -->
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
                    <h2 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                        <span class="w-6 h-6 rounded-full bg-green-100 text-green-600 flex items-center justify-center text-xs">4</span>
                        Logo trung tâm
                    </h2>
                    <div class="flex items-center gap-4">
                        <label class="flex-1 cursor-pointer group">
                            <div class="w-full h-32 border-2 border-dashed border-gray-300 rounded-xl flex flex-col items-center justify-center gap-2 group-hover:border-blue-500 group-hover:bg-blue-50 transition-all">
                                <svg class="w-8 h-8 text-gray-400 group-hover:text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                                <span class="text-sm text-gray-500 group-hover:text-blue-600">Bấm để tải ảnh logo</span>
                            </div>
                            <input type="file" id="logo-input" accept="image/*" class="hidden">
                        </label>
                        <div class="w-1/3">
                             <button id="clear-logo" class="w-full py-2 px-4 rounded-lg border border-red-200 text-red-600 hover:bg-red-50 text-sm font-medium transition hidden">
                                Xóa Logo
                            </button>
                        </div>
                    </div>
                </div>

            </div>

            <!-- Cột bên phải: Xem trước (Sticky) -->
            <div class="lg:col-span-5">
                <div class="sticky top-24 space-y-6">
                    <div class="bg-white p-8 rounded-3xl shadow-xl border border-gray-100 text-center relative overflow-hidden">
                        <!-- Decorative bg -->
                        <div class="absolute top-0 left-0 w-full h-32 bg-gradient-to-br from-blue-50 to-indigo-50 z-0"></div>
                        
                        <h3 class="relative z-10 text-gray-800 font-bold text-lg mb-6">Xem trước (Live Preview)</h3>
                        
                        <!-- QR Container -->
                        <div class="relative z-10 flex justify-center items-center min-h-[300px]">
                            <div id="canvas" class="bg-white p-4 rounded-xl shadow-sm mx-auto"></div>
                        </div>

                        <!-- Actions -->
                        <div class="relative z-10 mt-8 grid grid-cols-2 gap-3">
                            <select id="file-ext" class="px-4 py-3 rounded-xl border border-gray-200 bg-gray-50 text-gray-700 font-medium outline-none cursor-pointer">
                                <option value="png">Định dạng PNG</option>
                                <option value="jpeg">Định dạng JPEG</option>
                                <option value="webp">Định dạng WEBP</option>
                            </select>
                            <button id="download-btn" class="flex items-center justify-center gap-2 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-bold py-3 px-6 rounded-xl shadow-lg shadow-blue-200 transition-all transform hover:-translate-y-0.5 active:translate-y-0">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                                Tải xuống
                            </button>
                        </div>
                    </div>

                    <!-- Mẹo -->
                    <div class="bg-yellow-50 border border-yellow-100 rounded-xl p-4 flex gap-3">
                        <svg class="w-6 h-6 text-yellow-600 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        <p class="text-sm text-yellow-800">
                            <strong>Mẹo thiết kế:</strong> Hãy đảm bảo màu mã QR (dots) đủ tối và màu nền đủ sáng để camera điện thoại có thể quét dễ dàng.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Khởi tạo thư viện QRCodeStyling
        const qrCode = new QRCodeStyling({
            width: 300,
            height: 300,
            type: "canvas", // hoặc 'svg'
            data: "https://www.example.com",
            image: "",
            dotsOptions: {
                color: "#2563eb",
                type: "rounded"
            },
            backgroundOptions: {
                color: "#ffffff",
            },
            imageOptions: {
                crossOrigin: "anonymous",
                margin: 5, // Khoảng cách xung quanh logo
                imageSize: 0.4 // Kích thước logo (0-1)
            },
            cornersSquareOptions: {
                type: "extra-rounded",
                color: "#2563eb"
            },
            cornersDotOptions: {
                type: "dot",
                color: "#2563eb"
            }
        });

        // Hàm render QR Code
        const renderQR = () => {
            document.getElementById("canvas").innerHTML = "";
            qrCode.append(document.getElementById("canvas"));
        };

        // Render lần đầu
        renderQR();

        // --- CÁC HÀM XỬ LÝ SỰ KIỆN ---

        // 1. Cập nhật nội dung
        const qrDataInput = document.getElementById("qr-data");
        qrDataInput.addEventListener("keyup", () => {
            const val = qrDataInput.value.trim();
            qrCode.update({ data: val || "https://www.example.com" });
        });

        // 2. Cập nhật kiểu chấm (Dots)
        const dotsStyle = document.getElementById("dots-style");
        dotsStyle.addEventListener("change", (e) => {
            qrCode.update({
                dotsOptions: { type: e.target.value }
            });
        });

        // 3. Cập nhật kiểu góc (Corners)
        const cornersStyle = document.getElementById("corners-style");
        cornersStyle.addEventListener("change", (e) => {
            qrCode.update({
                cornersSquareOptions: { type: e.target.value },
                cornersDotOptions: { type: e.target.value === 'square' ? 'square' : 'dot' }
            });
        });

        // 4. Cập nhật màu sắc
        const colorDots = document.getElementById("color-dots");
        const colorBg = document.getElementById("color-bg");

        const updateColors = () => {
            const dotColor = colorDots.value;
            const bgColor = colorBg.value;
            qrCode.update({
                dotsOptions: { color: dotColor },
                cornersSquareOptions: { color: dotColor },
                cornersDotOptions: { color: dotColor },
                backgroundOptions: { color: bgColor }
            });
        };

        colorDots.addEventListener("input", updateColors);
        colorBg.addEventListener("input", updateColors);

        // 5. Xử lý tải lên Logo
        const logoInput = document.getElementById("logo-input");
        const clearLogoBtn = document.getElementById("clear-logo");

        logoInput.addEventListener("change", (e) => {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (event) => {
                    qrCode.update({
                        image: event.target.result
                    });
                    clearLogoBtn.classList.remove("hidden");
                };
                reader.readAsDataURL(file);
            }
        });

        clearLogoBtn.addEventListener("click", () => {
            qrCode.update({ image: "" });
            logoInput.value = "";
            clearLogoBtn.classList.add("hidden");
        });

        // 6. Tải xuống
        const downloadBtn = document.getElementById("download-btn");
        const fileExt = document.getElementById("file-ext");

        downloadBtn.addEventListener("click", () => {
            const ext = fileExt.value;
            const dataVal = qrDataInput.value.trim();
            // Tạo tên file từ nội dung hoặc mặc định
            let fileName = "qr-code";
            if (dataVal) {
                fileName = dataVal.replace(/[^a-zA-Z0-9]/g, "_").substring(0, 15);
            }
            
            qrCode.download({
                name: fileName,
                extension: ext
            });
        });

    </script>
</body>
</html>

